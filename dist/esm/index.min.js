class e{code;message;index;line;column;constructor(e,s,c,a,E){this.code=e,this.message=s,this.index=c,this.line=a,this.column=E}}var s;!function(e){e[e.E001=1]="E001",e[e.E002=2]="E002",e[e.E003=3]="E003",e[e.E004=4]="E004",e[e.E005=5]="E005",e[e.E006=6]="E006"}(s||(s={}));const c={};c[s.E001]={code:"E001",desc:"Unexpected apostrophe."},c[s.E002]={code:"E002",desc:"Unexpected quote."},c[s.E003]={code:"E003",desc:"Unexpected character."},c[s.E004]={code:"E004",desc:"Unexpected digit."},c[s.E005]={code:"E005",desc:"Missing closing apostrophe."},c[s.E006]={code:"E006",desc:"Missing closing quote."};const a=",",E=";",r="\r",t="\n",n=r+t,T="'",o='"',I=" ";var i;function N(e){switch(e){case i.START:return"START";case i.INTEGER:return"INTEGER";case i.DECIMAL:return"DECIMAL";case i.SCIENTIFIC:return"SCIENTIFIC";case i.APOS_STRING:return"APOS_STRING";case i.APOS_ESCAPE:return"APOS_ESCAPE";case i.QUOTE_STRING:return"QUOTE_STRING";case i.QUOTE_ESCAPE:return"QUOTE_ESCAPE";case i.DELIM:return"DELIM";case i.ISO8601_HHMM:return"ISO8601_HHMM";case i.UNQUOTED_STRING:return"UNQUOTED_STRING";case i.EXPONENT:return"EXPONENT";case i.SIGNED_EXPONENT:return"SIGNED_EXPONENT";case i.NEGATIVE_INTEGER:return"NEGATIVE_INTEGER";case i.TRAILING_WHITESPACE:return"TRAILING_WHITESPACE"}throw new Error(`decodeState(${e})`)}!function(e){e[e.START=0]="START",e[e.INTEGER=1]="INTEGER",e[e.DECIMAL=2]="DECIMAL",e[e.SCIENTIFIC=3]="SCIENTIFIC",e[e.APOS_STRING=4]="APOS_STRING",e[e.APOS_ESCAPE=5]="APOS_ESCAPE",e[e.QUOTE_STRING=6]="QUOTE_STRING",e[e.QUOTE_ESCAPE=7]="QUOTE_ESCAPE",e[e.DELIM=8]="DELIM",e[e.ISO8601_HHMM=9]="ISO8601_HHMM",e[e.UNQUOTED_STRING=10]="UNQUOTED_STRING",e[e.EXPONENT=11]="EXPONENT",e[e.SIGNED_EXPONENT=12]="SIGNED_EXPONENT",e[e.NEGATIVE_INTEGER=13]="NEGATIVE_INTEGER",e[e.TRAILING_WHITESPACE=14]="TRAILING_WHITESPACE"}(i||(i={}));const d=/^\d+$/,u=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/,S=/^\s|\s$|,|"|\n/;function l(e){const s=[],c=e.fields.map((e=>e.id));s.push(c);for(const a of e.records){const e=c.map((e=>a[e]));s.push(e)}return s}function A(e){const s={delim:a,escape:!0,lineTerm:t,quoteChar:o,skipRows:0,trim:!0};if(e){if("string"==typeof e.fieldDelimiter)switch(e.fieldDelimiter){case a:case E:s.delim=e.fieldDelimiter;break;default:throw new Error(`Unexpected dialect field delimiter ${e.fieldDelimiter}.`)}if("boolean"==typeof e.escapeEmbeddedQuotes&&(s.escape=e.escapeEmbeddedQuotes),"string"==typeof e.lineTerminator)switch(e.lineTerminator){case t:case r:case n:s.lineTerm=t;break;default:throw new Error(`Unexpected dialect lineTerminator ${e.lineTerminator}.`)}if("string"==typeof e.quoteChar)switch(e.quoteChar){case T:case o:s.quoteChar=e.quoteChar;break;default:throw new Error(`Unexpected dialect quoteChar ${e.quoteChar}.`)}"number"==typeof e.skipInitialRows&&(s.skipRows=e.skipInitialRows),"boolean"==typeof e.trimFields&&(s.trim=e.trimFields)}return s}function h(e,s){const c=e instanceof Array?e:l(e),a=A(s);let E="";for(let e=0;e<c.length;e+=1){const s=c[e];let t="";for(let e=0;e<s.length;e+=1){const c=(null===(r=s[e])?r="":"string"==typeof r&&S.test(r)?(a.escape&&(r=r.replace(/"/g,'""')),r=a.quoteChar+r+a.quoteChar):"number"==typeof r&&(r=r.toString(10)),r);e===s.length-1?(t+=c,E+=t+a.lineTerm,t=""):t+=c+a.delim}}var r;return E}function b(E,n,S){const{s:l,options:h}=function(e,s){(!s||s&&!s.lineTerminator)&&(e=function(e,s={}){return s.lineTerminator?e:e.replace(/(\r\n|\n|\r)/gm,"\n")}(e,s));const c=A(s);return{s:(a=e,E=c.lineTerm,a.charAt(a.length-E.length)!==E?a:a.substring(0,a.length-E.length)),options:c};var a,E}(E,n);let b=i.START;const k=l.length;let R="",_=Number.MAX_SAFE_INTEGER,p="",G=[],O=[];const f=function(e){return""===e?null:(h.trim&&(e=e.trim()),d.test(e)?parseInt(e,10):u.test(e)?parseFloat(e):e)},P=function(e){if(!S)throw e;S.push(e)};for(let E=0;E<k;E+=1)switch(R=l.charAt(E),b){case i.START:switch(R){case" ":break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R,b=i.INTEGER;break;case o:_=E,b=i.QUOTE_STRING;break;case T:b=i.APOS_STRING;break;case"+":b=i.INTEGER;break;case"-":p+=R,b=i.NEGATIVE_INTEGER;break;default:p+=R,b=i.UNQUOTED_STRING}break;case i.INTEGER:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;case".":p+=R,b=i.DECIMAL;break;case":":p+=R,b=i.ISO8601_HHMM;break;case"e":p+=R,b=i.EXPONENT;break;case a:p=f(p),G.push(p),p="",b=i.DELIM;break;case T:{const a=c[s.E001];P(new e(a.code,a.desc,E,1,0));break}case o:{const a=c[s.E002];P(new e(a.code,a.desc,E,1,0));break}case I:p=f(p),G.push(p),p="",b=i.TRAILING_WHITESPACE;break;case t:case r:p=f(p),G.push(p),p="",O.push(G),G=[],b=i.START;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.NEGATIVE_INTEGER:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;case".":p+=R,b=i.DECIMAL;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.DECIMAL:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;case"e":p+=R,b=i.EXPONENT;break;case h.delim:p=f(p),G.push(p),p="",b=i.DELIM;break;case T:{const a=c[s.E001];P(new e(a.code,a.desc,E,1,0));break}case o:{const a=c[s.E002];P(new e(a.code,a.desc,E,1,0));break}case I:p=f(p),G.push(p),p="",b=i.TRAILING_WHITESPACE;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.APOS_STRING:if(R===T)b=i.APOS_ESCAPE;else p+=R;break;case i.QUOTE_STRING:if(R===o)b=i.QUOTE_ESCAPE;else p+=R;break;case i.QUOTE_ESCAPE:switch(R){case o:p+=R,b=i.QUOTE_STRING;break;case h.delim:G.push(p),p="",b=i.DELIM;break;case t:G.push(p),p="",O.push(G),G=[],b=i.START;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.APOS_ESCAPE:switch(R){case T:p+=R,b=i.APOS_STRING;break;case h.delim:G.push(p),p="",b=i.DELIM;break;case t:G.push(p),p="",O.push(G),G=[],b=i.START;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.DELIM:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R,b=i.INTEGER;break;case I:break;case"+":b=i.INTEGER;break;case"-":p+=R,b=i.NEGATIVE_INTEGER;break;case o:_=E,b=i.QUOTE_STRING;break;case T:_=E,b=i.APOS_STRING;break;default:p+=R,b=i.UNQUOTED_STRING}break;case i.ISO8601_HHMM:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;case t:case r:p=f(p),G.push(p),p="",O.push(G),G=[],b=i.START;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.UNQUOTED_STRING:switch(R){case h.delim:G.push(p),p="",b=i.DELIM;break;case t:case r:G.push(p),p="",O.push(G),G=[],b=i.START;break;default:p+=R}break;case i.EXPONENT:switch(R){case"+":case"-":p+=R,b=i.SIGNED_EXPONENT;break;case I:p=f(p),G.push(p),p="",b=i.TRAILING_WHITESPACE;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.SIGNED_EXPONENT:switch(R){case I:p=f(p),G.push(p),p="",b=i.TRAILING_WHITESPACE;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":p+=R;break;case t:case r:p=f(p),G.push(p),p="",O.push(G),G=[],b=i.START;break;default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;case i.TRAILING_WHITESPACE:switch(R){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const a=c[s.E004];P(new e(a.code,a.desc,E,1,0));break}default:{const a=c[s.E003];P(new e(a.code,a.desc,E,1,0))}}break;default:throw new Error(`Unexpected state ${N(b)} at ${E} for ${l}`)}switch(b){case i.INTEGER:case i.DECIMAL:case i.EXPONENT:case i.SIGNED_EXPONENT:case i.APOS_ESCAPE:case i.QUOTE_ESCAPE:case i.ISO8601_HHMM:p=f(p),G.push(p),p="",O.push(G),G=[];break;case i.DELIM:G.push(null),p="",O.push(G),G=[];break;case i.APOS_STRING:{const a=c[s.E005];P(new e(a.code,a.desc,_,1,0));break}case i.QUOTE_STRING:{const a=c[s.E006];P(new e(a.code,a.desc,_,1,0));break}case i.START:case i.TRAILING_WHITESPACE:break;default:throw new Error(`Unexpected end state ${N(b)} ${l}`)}return h.skipRows&&(O=O.slice(h.skipRows)),O}export{e as CSVError,l as dataToArrays,b as parse,h as serialize};
//# sourceMappingURL=index.min.js.map
